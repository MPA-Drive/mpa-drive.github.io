<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Model-Based Policy Adaptation (MPA) for Closed-Loop End-to-End Autonomous Driving">
  <meta name="keywords" content="Autonomous Driving, Diffusion Model, Policy Adaptation">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>MPA: Model-Based Policy Adaptation for Closed-Loop End-to-End Autonomous Driving</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

<!-- <nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://keunhong.com">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>

      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More Research
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://hypernerf.github.io">
            HyperNeRF
          </a>
          <a class="navbar-item" href="https://nerfies.github.io">
            Nerfies
          </a>
          <a class="navbar-item" href="https://latentfusion.github.io">
            LatentFusion
          </a>
          <a class="navbar-item" href="https://photoshape.github.io">
            PhotoShape
          </a>
        </div>
      </div>
    </div>

  </div>
</nav> -->


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">MPA: Model-Based Policy Adaptation for Closed-Loop End-to-End Autonomous Driving</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://hhlin.info/">Haohong Lin</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://ai.stanford.edu/~yzzhang/">Yunzhi Zhang</a><sup>2</sup>,</span>
            <span class="author-block">
              <a href="https://wenhao.pub/">Wenhao Ding</a><sup>3</sup>,
            </span>
            <span class="author-block">
              <a href="https://jiajunwu.com/">Jiajun Wu</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="https://safeai-lab.github.io/#team">Ding Zhao</a><sup>1</sup>,
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>CMU, </span>
            <span class="author-block"><sup>2</sup>Stanford, </span>
            <span class="author-block"><sup>3</sup>NVIDIA</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="./paper.pdf"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/pdf/2511.21584"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Video Link. -->
              <span class="link-block">
                <a href="./slides.pdf"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Slides</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/HenryLHH/MPA"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code (Coming Soon)</span>
                  </a>
              </span>
              <!-- Dataset Link. -->
              <span class="link-block">
                <a href="https://huggingface.co/datasets/haohongl"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="far fa-images"></i>
                  </span>
                  <span>Data (Coming Soon)</span>
                  </a>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <video id="teaser" autoplay muted loop playsinline height="100%">
        <source src="./static/videos/teaser.mp4"
                type="video/mp4">
      </video>
      <h2 class="subtitle has-text-centered">
        MPA enables E2E driving agents to adapt to challenging scenarios in closed-loop simulation.
      </h2>
    </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            End-to-end (E2E) autonomous driving models have demonstrated strong performance in 
            open-loop evaluations but often suffer from cascading errors and poor generalization in closed-loop settings. 
            To address this gap, we propose Model-based Policy Adaptation (MPA), a general framework that enhances the robustness and safety of pretrained E2E driving agents during deployment. 
          </p>
          
          <p>
            MPA first generates diverse counterfactual trajectories using a geometry-consistent simulation engine, exposing the agent to scenarios beyond the original dataset. Based on this generated data, MPA trains a diffusion-based policy adapter to refine the base policy's predictions and a multi-step Q value model to evaluate long-term outcomes. 
            At inference time, the adapter proposes multiple trajectory candidates, and the Q value model selects the one with the highest expected utility. Experiments on the nuScenes benchmark using a photorealistic closed-loop simulator demonstrate that MPA significantly improves performance across in-domain, out-of-domain, and safety-critical scenarios. 
            We further investigate how the scale of counterfactual data and inference-time guidance strategies affect overall effectiveness. 
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

    <!-- Paper video. -->
    <!-- <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Video</h2>
        <div class="publication-video">
          <iframe src="https://www.youtube.com/embed/MrKrnHhk8IA?rel=0&amp;showinfo=0"
                  frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
      </div>
    </div> -->
    <!--/ Paper video. -->
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">

    <div class="columns is-centered">
      <div class="column is-full">
        <div class="content">
          <h2 class="title is-3">Motivation: Performance in Closed-Loop Evaluation</h2>
        </div>
      </div>
    </div>

    <div class="columns is-centered">
      <div class="column is-half">
        <div class="content">
          <p>
            We compare the L2 error of the E2E policy under different data sources on the right figure. We use a 3DGS-based simulator <a href="https://arxiv.org/pdf/2412.01718" target="_blank" rel="noopener noreferrer">HUGSIM</a> to reconstruct the scenes from the nuScenes dataset and compare the performance difference using ground truth data among all three E2E policies, we see a very close open-loop performance in motion prediction. This confirms the fidelity of the 3DGS-based simulation in its reconstruction quality. 
          </p>
          <p>
            We also find that the open-loop pretrained E2E driving agents like UniAD have performance degradation in closed-loop evaluation due to the distribution shift caused by compounding errors. 
          </p>
          <p>
            We further visualize some qualitative examples for the failure modes below. 
          </p>
        </div>
      </div>
      <div class="column is-half">
        <div class="content has-text-centered">
          <img src="./static/images/2_closed_loop_error.jpg" 
               style="width: 100%;"
               alt="Closed-Loop Error Analysis">
        </div>
      </div>
    </div>

    <div class="columns is-centered">
      <div class="column is-half">
        <div class="content">
          <p>
            Driving off the road to non drive-able area near a construction zone.
          </p>
          <video id="closed-loop-failure1" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/closed-loop_failure1.mp4" type="video/mp4">
          </video>
        </div>
      </div>

      <div class="column is-half">
        <div class="content">
          <p>
            Crashing on a stopping vehicle ahead with no collision avoidance.
          </p>
          <video id="closed-loop-failure2" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/closed-loop_failure2.mp4" type="video/mp4">
          </video>
        </div>
      </div>
    </div>

  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Animation. -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Core Contribution</h2>

        <!-- Interpolating. -->
        <!-- <h3 class="title is-4">Interpolating states</h3>
        <div class="content has-text-justified">
          <p>
            We can also animate the scene by interpolating the deformation latent codes of two input
            frames. Use the slider here to linearly interpolate between the left frame and the right
            frame.
          </p>
        </div>
        <div class="columns is-vcentered interpolation-panel">
          <div class="column is-3 has-text-centered">
            <img src="./static/images/interpolate_start.jpg"
                 class="interpolation-image"
                 alt="Interpolate start reference image."/>
            <p>Start Frame</p>
          </div>
          <div class="column interpolation-video-column">
            <div id="interpolation-image-wrapper">
              Loading...
            </div>
            <input class="slider is-fullwidth is-large is-info"
                   id="interpolation-slider"
                   step="1" min="0" max="100" value="0" type="range">
          </div>
          <div class="column is-3 has-text-centered">
            <img src="./static/images/interpolate_end.jpg"
                 class="interpolation-image"
                 alt="Interpolation end reference image."/>
            <p class="is-bold">End Frame</p>
          </div>
        </div>
        <br/> -->
        <!--/ Interpolating. -->

        <!-- Re-rendering. -->
        <h3 class="title is-4">Methodology Overview</h3>
        <div class="content has-text-justified">
          <p>
            MPA includes three key modules: (i) Counterfactual Data Generation to diversify the ego's behavior, 
            (ii) a Diffusion-based Policy Adapter to refine the base policy's actions, 
            and (iii) a Multi-step Q Value Model to evaluate and select the best action sequence at inference time.
            For more details, welcome to check our <a href="https://arxiv.org/pdf/2511.21584">paper</a>.
          </p>
        </div>
        <div class="content has-text-centered">
          <img src="./static/images/1_overview.jpg" 
               style="width: 70%;"
               alt="MPA Methodology Overview">
        </div>
        <h3 class="title is-4">Key Experiment Results</h3>
        <div class="content has-text-justified">
          <p>
            MPA-enhanced End-to-End driving agents outperform the base policies across in-domain, out-of-domain, and safety-critical scenarios in closed-loop simulation.
          </p>
        </div>
        <div class="content has-text-centered">
          <img src="./static/images/Table1.png" 
               style="width: 70%;"
               alt="MPA Methodology Overview">
        </div>
        <div class="content has-text-centered">
          <img src="./static/images/Table2.png" 
               style="width: 70%;"
               alt="MPA Methodology Overview">
        </div>   
      </div>
    </div>
    <!--/ Animation. -->
  </div>
</section>


    <section class="section">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column is-full">
            <h2 class="title is-3">Qualitative results of the Closed-Loop Evaluation</h2>
          </div>
        </div>
      </div>
    </section>

    <section class="hero is-light is-small">
      <div class="hero-body">
        <div class="container is-widescreen">
          <div id="results-carousel" class="carousel results-carousel" style="max-height: 600px;">
            <div class="item item-video-0001">
              <video poster="" id="video-0001" autoplay controls muted loop playsinline hâ‰ˆ>
                <source src="./static/videos/video_0001.mp4"
                        type="video/mp4">
              </video>
            </div>
            <div class="item item-video-0004">
              <video poster="" id="video-0004" autoplay controls muted loop playsinline height="100%">
                <source src="./static/videos/video_0004.mp4"
                        type="video/mp4">
              </video>
            </div>
            <div class="item item-video-0005">
              <video poster="" id="video-0005" autoplay controls muted loop playsinline height="100%">
                <source src="./static/videos/video_0005.mp4"
                        type="video/mp4">
              </video>
            </div>
            <div class="item item-video-0006">
              <video poster="" id="video-0006" autoplay controls muted loop playsinline height="100%">
                <source src="./static/videos/video_0006.mp4"
                        type="video/mp4">
              </video>
            </div>
            <div class="item item-video-0009">
              <video poster="" id="video-0009" autoplay controls muted loop playsinline height="100%">
                <source src="./static/videos/video_0009.mp4"
                        type="video/mp4">
              </video>
            </div>
            <div class="item item-video-0010">
              <video poster="" id="video-0010" autoplay controls muted loop playsinline height="100%">
                <source src="./static/videos/video_0010.mp4"
                        type="video/mp4">
              </video>
            </div>
            <div class="item item-video-0043">
              <video poster="" id="video-0043" autoplay controls muted loop playsinline height="100%">
                <source src="./static/videos/video_0043.mp4"
                        type="video/mp4">
              </video>
            </div>
            <div class="item item-video-0191">
              <video poster="" id="video-0191" autoplay controls muted loop playsinline height="100%">
                <source src="./static/videos/video_0191.mp4"
                        type="video/mp4">
              </video>
            </div>
            <div class="item item-video-0196">
              <video poster="" id="video-0196" autoplay controls muted loop playsinline height="100%">
                <source src="./static/videos/video_0196.mp4"
                        type="video/mp4">
              </video>
            </div>
            <div class="item item-video-0446">
              <video poster="" id="video-0446" autoplay controls muted loop playsinline height="100%">
                <source src="./static/videos/video_0446.mp4"
                        type="video/mp4">
              </video>
            </div>
            <div class="item item-video-0457">
              <video poster="" id="video-0457" autoplay controls muted loop playsinline height="100%">
                <source src="./static/videos/video_0457.mp4"
                        type="video/mp4">
              </video>
            </div>
            <div class="item item-video-0458">
              <video poster="" id="video-0458" autoplay controls muted loop playsinline height="100%">
                <source src="./static/videos/video_0458.mp4"
                        type="video/mp4">
              </video>
            </div>
            <div class="item item-video-0459">
              <video poster="" id="video-0459" autoplay controls muted loop playsinline height="100%">
                <source src="./static/videos/video_0459.mp4"
                        type="video/mp4">
              </video>
            </div>
            <div class="item item-video-0475">
              <video poster="" id="video-0475" autoplay controls muted loop playsinline height="100%">
                <source src="./static/videos/video_0475.mp4"
                        type="video/mp4">
              </video>
            </div>
            <div class="item item-video-0477">
              <video poster="" id="video-0477" autoplay controls muted loop playsinline height="100%">
                <source src="./static/videos/video_0477.mp4"
                        type="video/mp4">
              </video>
            </div>
            <div class="item item-video-0479">
              <video poster="" id="video-0479" autoplay controls muted loop playsinline height="100%">
                <source src="./static/videos/video_0479.mp4"
                        type="video/mp4">
              </video>
            </div>
            <div class="item item-video-0480">
              <video poster="" id="video-0480" autoplay controls muted loop playsinline height="100%">
                <source src="./static/videos/video_0480.mp4"
                        type="video/mp4">
              </video>
            </div>
            <div class="item item-video-0499">
              <video poster="" id="video-0499" autoplay controls muted loop playsinline height="100%">
                <source src="./static/videos/video_0499.mp4"
                        type="video/mp4">
              </video>
            </div>
          </div>
        </div>
      </div>
    </section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Concurrent Work. -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Related Links</h2>

        <div class="content has-text-justified">
          <p>
            There's a lot of excellent work that provides useful resources or share similar insights with our MPA framework. 
            <a href="https://arxiv.org/pdf/2412.01718">HUGSIM</a> introduces an decomposed scene representation in the 3DGS to render photorealistic driving scenes, which paves our way to generate counterfactual driving scenarios.
            <a href="https://arxiv.org/abs/2411.15139">DiffusionDrive</a> introduces a truncated diffusion policy framework to enhance the robustness of E2E driving agents. 
            <a href="https://arxiv.org/pdf/2510.04333">RAP</a> introduces a rasterization-augmented planning to augment the ego's policy with diverse behaviors from surrounding vehicles to bridge the sim-to-real gap of E2E planning. 
          </p>
          <p>
            Our experiment is conducted using open-source E2E models, including <a href="https://arxiv.org/pdf/2212.10156">UniAD</a>, <a href="https://arxiv.org/pdf/2303.12077">VAD</a>, <a href="https://arxiv.org/pdf/2205.15997">LTF</a>, and <a href="https://arxiv.org/pdf/2406.08481">LAW</a>. 
          </p>
        </div>
      </div>
    </div>
    <!--/ Concurrent Work. -->
  </div>
</section>


<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@inproceedings{lin2025modelbased,
  title     = {Model-Based Policy Adaptation for Closed-Loop End-to-end Autonomous Driving},
  author    = {Haohong Lin and Yunzhi Zhang and Wenhao Ding and Jiajun Wu and Ding Zhao},
  booktitle = {The Thirty-ninth Annual Conference on Neural Information Processing Systems},
  year      = {2025},
  url       = {https://openreview.net/forum?id=4OLbpaTKJe}
}</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="./paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="./slides.pdf" class="external-link" disabled>
        <i class="fas fa-file-powerpoint"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            This means you are free to borrow the <a
              href="https://github.com/mpa-drive/mpa-drive.github.io">source code</a> of this website,
            we just ask that you link back to this page in the footer.
            Please remember to remove the analytics code included in the header of the website which
            you do not want on your website.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
